<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>華南產物保險-RIAF013-同業往來維護</title>
    <!-- favicon -->
    <link rel="shortcut icon" href="img/favicon.ico">
    <!-- jQuery-ui -->
    <link rel="stylesheet" href="css/jquery-ui.css">
    <link rel="stylesheet" href="css/jquery-ui.theme.css">
    <!-- Bootstrap_4.5.2 -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- material_icon -->
    <link rel="stylesheet" href="css/material-icons.css">
    <link rel="stylesheet" href="css/material-icons-ie.css">
    <!-- tabulator_4.9 -->
    <link rel="stylesheet" href="css/tabulator.min.css">
    <!-- 全域 -->
    <link rel="stylesheet" href="css/global.css">
    <!-- 框架 -->
    <link rel="stylesheet" href="css/layout.css">
    <!-- 頁面 -->
    <link rel="stylesheet" href="css/page.css">
    <!-- pg使用 -->
    <link rel="stylesheet" href="css/pg.css">
</head>

<body id="canvas" class="riaf013-01-query">
    <div class="frame">
        <!-- frame: menu -->
        <nav class="frame-block leftBlock" id="left_menu">
            <div class="leftBlock-inner mCustomScrollbar">
                <!-- menu-logo -->
                <div class="frame-logo">
                    <a href="#"><img src="img/logo-w.svg" alt=""></a>
                </div>
                <div class="frame-menu">
                    <!-- menu-filter -->
                    <div class="menu-filter">
                        <input type="text" id="menu_filter" placeholder="搜尋目錄">
                    </div>
                    <div class="menu-pgName"><span>同業往來</span></div>
                    <!-- menu-list -->
                    <div class="menu-list" include-html="include/menu/trade-current-account.html"></div>
                </div>
            </div>
        </nav>
        <!-- frame: content -->
        <div class="frame-block rightBlock" id="right_content">
            <!-- header -->
            <header class="frame-content headerModule">
                <div class="header-list" include-html-header="include/header/reinsurance/header.html"></div>
            </header>
            <!-- main -->
            <main class="frame-content mainModule">
                <div class="content">
                    <!-- breadcrumb -->
                    <div class="content-component content-breadcrumb">
                        <div class="globl-category">
                            <div class="globl-category-inner">
                                <select name="" id="">
                                    <option value="">非OIU</option>
                                    <option value="">OIU</option>
                                </select>
                            </div>
                        </div>
                        <ul>
                            <li><a href="#">再保</a></li>
                            <li><a href="#">同業往來</a></li>
                            <li><a href="#">同業往來維護</a></li>
                            <li><a href="#">11008017</a></li>
                        </ul>
                    </div>
                    <!-- card -->
                    <div class="content-component content-card content-next">
                        <!-- unitname -->
                        <div class="content-component content-unitname">
                            <div class="unitname-inner">
                                <div class="unitname-item unitname-title sub-unitname-title" belongto="#清帳作業">對帳批號<span>11008017</span></div>
                                <div class="unitname-item unitname-cancel">
                                    <a href="riaf013-tab2-01-query.html" data-toggle="tooltip" title="取消" data-placement="left"><span class="material-icons">cancel</span></a>
                                </div>
                            </div>
                        </div>
                        <!-- unittab -->
                        <div class="card-detail">
                            <!-- card-detail >> board -->
                            <div class="detail-board detail-board-unittab">
                                <!-- unitTab -->
                                <div class="content-component content-unittab">
                                    <ul>
                                        <li><a href="riaf013-tab2-detail-tab1-query.html">清帳作業</a></li>
                                        <li><a href="riaf013-tab2-detail-tab2-query.html">暫收付紀錄</a></li>
                                        <li><a href="riaf013-tab2-detail-tab3-query.html" class="unittab-active">付款設定</a></li>
                                        <li></li>
                                        <li></li>
                                        <li></li>
                                        <li></li>
                                        <li></li>
                                        <li></li>
                                        <li></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- button -->
                        <div class="card-detail">
                            <!-- card-detail >> board -->
                            <div class="detail-board detail-board-btn">
                                <!-- btn -->
                                <div class="content-component content-btn">
                                    <div class="content-btn-main">
                                        <ul>
                                            <li><button class="content-btn-item btn-main btn-clear"><span>清除</span></button></li>
                                            <li><button class="content-btn-item btn-main btn-query"><span>查詢</span></button></li>
                                            <li><button class="content-btn-item btn-main btn-add" type="button" onclick="location.href='riaf013-tab2-detail-tab3-add.html'"><span>新增</span></button></li>
                                            <li><button class="content-btn-item btn-main btn-modify" type="button" onclick="location.href='riaf013-tab2-detail-tab3-modify.html'"><span>修改</span></button></li>
                                            <li><button class="content-btn-item btn-main btn-delete" type="button" onclick="location.href='riaf013-tab2-detail-tab3-delete.html'"><span>刪除</span></button></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr class="seperate-line">
                        <!-- tabulator創立table -->
                        <div class="card-detail">
                            <!-- card-detail >> board -->
                            <div class="detail-board">
                                <div class="content-component content-table">
                                    <div class="table-func">
                                        <div class="table-func-inner">
                                            <div class="table-func-basic">
                                                <div class="func-basic-item func-download">
                                                    <ul>
                                                        <li><a href="#" class="table-excel" title="下載excel" data-toggle="tooltip" data-placement="top">EXCEL</a></li>
                                                    </ul>
                                                </div>
                                                <div class="func-basic-item func-count">
                                                    <ul>
                                                        <li class="count-total">3</li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="table-func-page"></div>
                                        </div>
                                    </div>
                                    <div id="table01"></div>
                                    <div class="table-footer"></div>
                                </div>
                            </div>
                        </div>
                        <!-- copyright -->
                        <div class="content-component content-copyright">[ V-1.0.1 ] ©2021 華南產物保險</div>
                    </div>
                </div>
                <div class="aside">
                    <div class="aside-list" include-html-aside="include/aside/aside.html"></div>
                </div>
            </main>
        </div>
    </div>
    <!-- popup-add -->
    <div class="content-component content-popup">
        <div class="popup-dialog popup-dialog-add">
            <form action="">
                <div class="dialog-header">
                    <div class="dialog-header-inner">
                        <div class="dialog-header-item dialog-title">銷帳編號<span>123456</span></div>
                        <div class="dialog-header-item dialog-cancel">
                            <a href="riaf013-tab2-detail-tab3-query.html"><span class="material-icons">cancel</span></a>
                        </div>
                    </div>
                </div>
                <div class="dialog-content">
                    <!-- customize-form -->
                    <div class="customize-form">
                        <div class="customize-form-row">
                            <div class="customize-form-header">
                                <span>付款設定</span>
                            </div>
                        </div>
                        <!-- 銷帳編號/收付代碼/付款幣別/匯款戶名 -->
                        <div class="customize-form-row">
                            <div class="customize-form-inner">
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">銷帳編號</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="銷帳編號" value="銷帳編號" title="" placeholder="請輸入值" data-toggle="tooltip" data-placement="left">
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">收付代碼</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="收付代碼" value="收付代碼" title="" placeholder="請輸入值" data-toggle="tooltip" data-placement="left">
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-popup-select customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">付款幣別</div>
                                        <div class="customize-form-entry">
                                            <a href="riaf013-tab2-detail-tab3-add-currency.html" attr="" title="AUD 澳幣" data-toggle="tooltip" data-placement="top">AUD 澳幣</a>
                                            <div class="customize-form-popup-select-cancel"><span class="material-icons">backspace</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">匯款戶名</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="匯款戶名" value="匯款戶名" title="" placeholder="請輸入值" data-toggle="tooltip" data-placement="left">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- 匯款帳號/匯款金額/即時兌換率 -->
                        <div class="customize-form-row">
                            <div class="customize-form-inner">
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">暫收付金額</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="暫收付金額" value="10,000" title="" placeholder="請輸入值" data-toggle="tooltip" data-placement="left" attr="">
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">匯款金額</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="匯款金額" value="10,000" title="" placeholder="請輸入值" data-toggle="tooltip" data-placement="left" attr="money">
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">即時兌換率</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="即時兌換率" value="1.00" title="" placeholder="請輸入值" data-toggle="tooltip" data-placement="left" attr="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="customize-form-row">
                            <div class="customize-form-header">
                                <span>付款設定</span>
                            </div>
                        </div>
                        <!-- 轉換本位幣金額/損益別/損益金額/手續費 -->
                        <div class="customize-form-row">
                            <div class="customize-form-inner">
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">轉換本位幣金額</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="轉換本位幣金額" value="10,000" title="" placeholder="請輸入值" data-toggle="tooltip" data-placement="left" attr="money">
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">損益別</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="損益別" value="" title="" placeholder="請輸入值" data-toggle="tooltip" data-placement="left">
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">損益金額</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="損益金額" value="" title="10,000" placeholder="請輸入值" data-toggle="tooltip" data-placement="left" attr="money">
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">手續費</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="手續費" value="" title="10" placeholder="請輸入值" data-toggle="tooltip" data-placement="left" attr="money">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- 其他金額/預計付款日/指定傳票日 -->
                        <div class="customize-form-row">
                            <div class="customize-form-inner">
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">其他金額</div>
                                        <div class="customize-form-entry">
                                            <input type="text" name="暫收付金額" value="10,000" title="" placeholder="請輸入值" data-toggle="tooltip" data-placement="left" attr="money">
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">預計付款日</div>
                                        <div class="customize-form-entry">
                                            <div class="query-datepicker-YMD">
                                                <div class="query-datepicker-YMD-inner">
                                                    <div class="query-datepicker-item query-datepicker-item-y">
                                                        <div><input type="text" maxlength="3" placeholder="yyy" value="YYY"></div>
                                                    </div>
                                                    <div class="query-datepicker-item query-datepicker-item-m">
                                                        <div><input type="text" maxlength="2" placeholder="mm" value="MM"></div>
                                                    </div>
                                                    <div class="query-datepicker-item query-datepicker-item-d">
                                                        <div><input type="text" maxlength="2" placeholder="dd" value="DD"></div>
                                                    </div>
                                                    <div class="query-datepicker-item query-datepicker-item-icon">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="customize-form-field customize-form-field-1">
                                    <div class="customize-field-inner">
                                        <div class="customize-form-title">指定傳票日</div>
                                        <div class="customize-form-entry">
                                            <div class="query-datepicker-YMD">
                                                <div class="query-datepicker-YMD-inner">
                                                    <div class="query-datepicker-item query-datepicker-item-y">
                                                        <div><input type="text" maxlength="3" placeholder="yyy" value="YYY"></div>
                                                    </div>
                                                    <div class="query-datepicker-item query-datepicker-item-m">
                                                        <div><input type="text" maxlength="2" placeholder="mm" value="MM"></div>
                                                    </div>
                                                    <div class="query-datepicker-item query-datepicker-item-d">
                                                        <div><input type="text" maxlength="2" placeholder="dd" value="DD"></div>
                                                    </div>
                                                    <div class="query-datepicker-item query-datepicker-item-icon">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dialog-btn">
                    <ul>
                        <li><button type="button" class="btn-prime" onclick="location.href='riaf013-tab2-detail-tab3-query.html'">確定</button></li>
                        <li><button type="button" class="btn-outline" onclick="location.href='riaf013-tab2-detail-tab3-query.html'">取消</button></li>
                    </ul>
                </div>
            </form>
        </div>
    </div>
</body>
<!-- jQuery_3.5.1  -->
<script src="js/jquery-3.5.1.min.js"></script>
<!-- jQuery-ui_1.12.1 -->
<script src="js/jquery-ui.js"></script>
<!-- Popper -->
<script src="js/popper.min.js"></script>
<!-- Bootstrap_4.5.2 -->
<script src="js/bootstrap.min.js"></script>
<!-- tabulator_4.9 -->
<script src="js/tabulator.min.js"></script>
<!-- tabulator_json -->
<!-- <script src="json/table01.js"></script> -->
<!-- 自定義js -->
<script src="js/layout.js"></script>
<!-- pg使用 -->
<script src="js/pg.js"></script>
<script>
let nestedData = [{
    id: "a3",
    銷帳編號: "銷帳編號",
    收付代碼: "收付代碼",
    付款幣別: "付款幣別",
    匯款戶名: "匯款戶名",
    匯款帳號: "匯款帳號",
    匯款金額: "匯款金額",
    即時兌換率: "即時兌換率",
    ntTable: [{
        轉換本位幣金額: "轉換本位幣金額",
        損益別: "損益別",
        損益金額: "損益金額",
        手續費: "手續費",
        其他金額: "其他金額",
        預計付款日: "預計付款日",
        指定傳票日: "指定傳票日"
    }, ]
}, ]

var table01 = new Tabulator("#table01", {
    height: "100%",
    layout: "fitColumns",
    movableColumns: true,
    data: nestedData,
    columns: [{
            formatter: "rowSelection",
            titleFormatter: "rowSelection",
            headerHozAlign: "center",
            hozAlign: "center",
            headerSort: false,
            maxWidth: 30,
            minWidth: 30,
            cellClick: function(e, cell) {
                cell.getRow().toggleSelect();
            }
        },
        {
            formatter: (cell, formatterParams, onRendered) => {
                let div = document.createElement('div');
                let el = cell.getRow().getElement()
                let btnName = ["＋", "–"]

                btnName.forEach((name, index) => {
                    let btn = document.createElement('button');
                    $(btn).text(name)
                    elementsChangeClass(btn, "add", "table-btn-switch")
                    btn.addEventListener("click", (e) => {
                        $(el).find(".table-btn-switch").toggle()
                        $(el).find(".table-subtable-container").toggle()
                    });
                    if (index === 1) {
                        $(btn).css("display", "none")
                    }
                    div.appendChild(btn)
                })
                return div
            },
            headerHozAlign: "center",
            hozAlign: "center",
            headerSort: false,
            maxWidth: 30,
            minWidth: 30
        },
        {
            title: "銷帳編號",
            field: "銷帳編號",
            formatter: function(cell, formatterParams, onRendered) {
                return "<a href='riaf013-tab2-detail-tab3-detail.html'>" + cell.getValue() + "</a>"
            },
        },
        { title: "收付代碼", field: "收付代碼" },
        { title: "付款幣別", field: "付款幣別" },
        { title: "匯款戶名", field: "匯款戶名" },
        { title: "匯款帳號", field: "匯款帳號" },
        { title: "匯款金額", field: "匯款金額" },
        { title: "即時兌換率", field: "即時兌換率" },
    ],
    rowFormatter: function(row) {
        let container = document.createElement("div");
        let subtable = document.createElement("div");

        $(container).css("display", "none")
        elementsChangeClass(container, "add", "table-subtable-container")
        elementsChangeClass(subtable, "add", "table-subtable")
        $(subtable).attr("id", row.getData().id)

        container.appendChild(subtable);
        row.getElement().appendChild(container);

        let subTable = new Tabulator("#" + row.getData().id, {
            layout: "fitColumns",
            data: row.getData().ntTable,
            columns: [
                { title: "轉換本位幣金額", field: "轉換本位幣金額", hozAlign: "right" },
                { title: "損益別", field: "損益別" },
                { title: "損益金額", field: "損益金額", hozAlign: "right" },
                { title: "手續費", field: "手續費", hozAlign: "right" },
                { title: "其他金額", field: "其他金額", hozAlign: "right" },
                { title: "預計付款日", field: "預計付款日" },
                { title: "指定傳票日", field: "指定傳票日" },
            ]
        })
    },
});

function elementsChangeClass(elements, behavior, classNames) {
    if (behavior === "add") {
        $(elements).each(function(index, element) {
            $(element).addClass(classNames)
        })
    } else if (behavior === "remove") {
        $(elements).each(function(index, element) {
            $(element).removeClass(classNames)
        })
    }
}
// 選擇預設勾選row
//table01.selectRow(["a1"]);
// 使用filter能精準指定欄位
//table.selectRow(table.setFilter("id","=","a1"));
</script>

</html>